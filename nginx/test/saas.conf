# http setting
server {
    listen 80;
    server_name saas.test.styd.cn;
    rewrite ^(.*)$  https://$host$1 permanent;
}
# https setting
server {
    listen 443 ssl;
    server_name saas.test.styd.cn;
    ssl on;
    ssl_certificate /application/nginx/ssl/_.test.styd.cn.cer;
    ssl_certificate_key /application/nginx/ssl/_.test.styd.cn.key;
####
# pirvate dns resolver
    resolver 101.132.119.70;
####
# vars definations
    set $saas_api "saas-test-api.styd.cn";
    set $htdoc /data/htdocs/frontend_saas_web/dist;
####
# logs
    access_log /data/logs/nginx/saas.access.log;
    error_log /data/logs/nginx/saas.error.log;
####
# /* -> /index.html to support spa history mode
    location / {
        root $htdoc;
        index index.html;
        try_files $uri /index.html;
    }
# proxy api
    location ^~ /_api {
        rewrite ^/_api(.*)$ /$1 break;
        proxy_pass http://$saas_api;
    }
}
